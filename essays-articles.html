<!DOCTYPE html>
<html lang="en">
<head>
  <title>Blog, Essays and Articles | Adam Lehodey</title>
  <meta charset="UTF-8">
  <link rel="shortcut icon" href="/site-resources/favicon.png" type="image/x-icon">
  <link rel="icon" href="/site-resources/favicon.png" type="image/x-icon">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
  
  <meta name="keywords" content="Adam Lehodey, Lehodey, Adam Louis Sebastian Lehodey, Adventures, Ideas, Global Denizen"> 
  <meta name="description" content="Adam Lehodey: Blog. Explore my work and opinion pieces from across the internet, all in one convenient place.">
  <meta name="author" content="Adam Louis Sebastian Lehodey">

  <!-- Open Graph / Facebook -->
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://adamlehodey.com/essays-articles.html">
  <meta property="og:title" content="Blog, Essays and Articles | Adam Lehodey">
  <meta property="og:description" content="Adam Lehodey: Blog. Explore my work and opinion pieces from across the internet, all in one convenient place.">
  <meta property="og:image" content="https://adamlehodey.com/site-resources/cover-photos/essays.jpg">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">
  <meta property="og:image:alt" content="Adam Lehodey Essays and Articles">

  <!-- Twitter -->
  <meta property="twitter:card" content="summary_large_image">
  <meta property="twitter:url" content="https://adamlehodey.com/essays-articles.html">
  <meta property="twitter:title" content="Blog, Essays and Articles | Adam Lehodey">
  <meta property="twitter:description" content="Adam Lehodey: Blog. Explore my work and opinion pieces from across the internet, all in one convenient place.">
  <meta property="twitter:image" content="https://adamlehodey.com/site-resources/cover-photos/essays.jpg">
  <meta property="twitter:image:alt" content="Adam Lehodey Essays and Articles">

  <!-- WhatsApp / iMessage / General -->
  <meta property="og:site_name" content="Adam Lehodey">
  <meta property="og:locale" content="en_US">

  <!-- Resource hints for faster loading -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="dns-prefetch" href="https://fonts.googleapis.com">
  <link rel="dns-prefetch" href="https://fonts.gstatic.com">
  
  <!-- Preload critical resources - TOP PRIORITY -->
  <link rel="preload" href="site-resources/topography.png" as="image" fetchpriority="high">
  <link rel="preload" href="site-resources/cover-photos/essays.jpg" as="image" fetchpriority="high">
  <link rel="preload" href="Styling.css" as="style" fetchpriority="high">
  <link rel="preload" href="blogstyling.css" as="style" fetchpriority="high">
  
  <!-- Preload secondary resources -->
  <link rel="preload" href="site-resources/LinkedIn.png" as="image" fetchpriority="low">
  <link rel="preload" href="site-resources/x-logo-white.png" as="image" fetchpriority="low">
  <link rel="preload" href="blog-posts.xml" as="fetch" crossorigin fetchpriority="low">
  
  <!-- Critical CSS inlined for above-the-fold content -->
  <style>
    html,body{margin:0;padding:0}:root{--mobile-social-nav-spacing:4vh}.page-fade{opacity:0;transition:opacity .1s ease-in-out}.page-fade.fade-in{opacity:1}.hero-background{position:fixed;top:0;left:0;width:100vw;height:calc(var(--vh,1vh)*100);object-fit:cover;z-index:-2}.top-nav-container{position:static;display:flex;justify-content:space-between;align-items:flex-start;width:100%;margin-top:5vh;z-index:2}.homepage-nav{display:inline-block;vertical-align:top;line-height:1;margin-left:5vw;font-family:"Libre Bodoni",serif;font-size:1.4vw;font-weight:300;color:black;z-index:2}.social-container{position:static;margin-right:5vw;margin-top:0;z-index:2}.blog-background-image{position:absolute;top:0;left:0;width:100vw;height:52vh;background-image:url('site-resources/cover-photos/essays.jpg');background-size:cover;background-position:center;background-repeat:no-repeat;z-index:-1}.blog-gradient-overlay{position:absolute;top:0;left:0;width:100vw;height:52vh;background:linear-gradient(to bottom,rgba(0,0,0,.8),rgba(0,0,0,0));z-index:0;pointer-events:none}#blog-container{margin-top:10vh;padding-top:2rem;position:relative;z-index:1}.blog-filter-bar{display:flex!important;flex-direction:column!important;justify-content:center;align-items:center;gap:10px;margin-top:10vh;margin-bottom:2rem;margin-left:5vw;margin-right:5vw;padding:20px;background:rgba(128,128,128,.2);border:1px solid rgba(255,255,255,.3);border-radius:8px;backdrop-filter:blur(10px);z-index:10}.blog-filter-bar .filter-text{color:white;font-family:'Libre Bodoni',serif;font-size:14px;font-weight:300;text-align:center;margin:0;opacity:.9;line-height:1.4}.blog-filter-bar .subscribe-link{color:white;text-decoration:underline;text-decoration-color:rgba(255,255,255,.6);text-underline-offset:3px;transition:all .3s ease;display:inline}.blog-filter-bar .subscribe-link:hover{text-decoration-color:white;opacity:1}.blog-filter-bar .filter-buttons-container{display:flex;justify-content:center;align-items:center;gap:20px;flex-wrap:wrap}@media (max-width:1000px){#blog-container{margin-top:0;padding-top:0}.blog-filter-bar{margin-bottom:0!important}#blog-container .brutalist-minimal-card:first-child{margin-top:0}.top-nav-container{position:relative;display:flex;flex-direction:column;margin-top:5vh;width:100%;text-align:center;align-items:center}.top-nav-container .social-container{order:1;display:flex!important;margin:0 auto var(--mobile-social-nav-spacing) auto}.top-nav-container .homepage-nav{order:2;font-size:16px;text-align:center;width:90vw;margin-left:5vw;margin-top:0}}@media (min-width:641px) and (max-width:1000px){.blog-filter-bar{margin-left:0;margin-right:0;border-radius:0;background:rgba(64,64,64,.2);margin-bottom:0!important;border-top:1px solid white;border-bottom:1px solid white;box-shadow:0 0 20px rgba(255,255,255,.3),0 0 40px rgba(255,255,255,.1)}#blog-container{margin-top:1rem;padding-top:0}}@media (max-width:640px){.homepage-nav{font-size:16px;text-align:center;width:90vw;margin-left:5vw}.social-icon{width:40px;height:40px}.blog-background-image{height:40vh}.blog-gradient-overlay{height:40vh}.blog-filter-bar{margin-left:0;margin-right:0;padding:12px 10px;gap:8px;border-radius:0;background:rgba(64,64,64,.2);margin-bottom:0!important}.blog-filter-bar .filter-text{font-size:12px;margin-bottom:4px;line-height:1.3}.blog-filter-bar .subscribe-link{text-underline-offset:2px}.blog-filter-bar .filter-buttons-container{gap:6px}}
  </style>

  <script>
    // iOS-safe viewport height variable
    (function() {
      function setVh() {
        var vh = window.innerHeight * 0.01;
        document.documentElement.style.setProperty('--vh', vh + 'px');
      }
      setVh();
      window.addEventListener('resize', setVh);
      window.addEventListener('orientationchange', setVh);
    })();
  </script>

  <link rel="stylesheet" type="text/css" href="Styling.css">
  <link rel="stylesheet" type="text/css" href="blogstyling.css">
  <link href="https://fonts.googleapis.com/css2?family=Abril+Fatface&family=Bentham&family=Bodoni+Moda:ital,opsz,wght@0,6..96,400..900;1,6..96,400..900&family=Droid+Serif&family=Josefin+Sans&family=Lora&family=Libre+Bodoni:ital,wght@0,400..700;1,400..700&family=Noto+Serif+Display:ital,wght@0,100..900;1,100..900&family=Quicksand&family=Raleway&family=Space+Grotesk:wght@300;400;500;600;700&family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
</head>

<body class="page-fade subpage blog-page">
  <img class="hero-background" src="site-resources/topography.png" alt="Topography Background" loading="eager">
  <div class="blog-background-image"></div>
  <div class="blog-gradient-overlay"></div>
  <div class="top-nav-container">
  	<div class="homepage-nav"><a class="homepage-nav-link" href="/">HOME</a><span class="nav-separator"> • </span><a class="homepage-nav-link" href="essays-articles">ESSAYS AND ARTICLES</a><span class="nav-separator"> • </span><a class="homepage-nav-link" href="biography">BIOGRAPHY</a><span class="nav-separator"> • </span><a class="homepage-nav-link" href="contact">CONTACT</a></div>
  	<div class="social-container">
		<a href="https://x.com/adamlehodey" target="_blank"><img class="social-icon" src="site-resources/x-logo-white.png" alt="X Link" loading="eager"></a>
		<a href="https://www.linkedin.com/in/adamlehodey/" target="_blank"><img class="social-icon" src="site-resources/LinkedIn.png" alt="LinkedIn Link" loading="eager"></a>
	</div>
  </div>
  <div class="block_1"></div> <hr class="content-divider" />

  <!-- Blog Filter Bar -->
  <div class="blog-filter-bar" id="blog-filter-bar">
    <!-- Filter buttons will be dynamically generated here -->
  </div>

  <div class="container" id="blog-container">
   <!-- Blog posts will be loaded here dynamically -->
  </div>

  <!-- Back to Top Button -->
  <a href="#" class="back-to-top" id="back-to-top" aria-label="Back to top">↑</a>

  <script>
  	// Page fade transition
  	document.addEventListener('DOMContentLoaded', function() {
  		// Use fallback background since no video is present
		const fallbackBg = document.querySelector('.fallback-background');
		if (fallbackBg) {
			fallbackBg.style.display = 'block';
		}
  		
 		// Fade in the page when it loads
 		document.body.classList.add('fade-in');
  		
 		// Handle navigation links for fade out effect
 		const navLinks = document.querySelectorAll('a[href]');
 		navLinks.forEach(link => {
 			// Only apply to internal links (not external or same page)
 			const href = link.getAttribute('href');
 			if (href && !href.startsWith('http') && !href.startsWith('#') && !href.startsWith('mailto:') && !href.startsWith('tel:')) {
 				link.addEventListener('click', function(e) {
 					// Don't apply to links that open in new tabs
 					if (!link.hasAttribute('target') || link.getAttribute('target') !== 'blank') {
 						e.preventDefault();
 						const targetUrl = this.getAttribute('href');
 						
 						// Fade out current page
 						document.body.classList.remove('fade-in');
 						document.body.classList.add('fade-out');
 						
 												// Navigate to new page after fade out
						setTimeout(() => {
							window.location.href = targetUrl;
						}, 100);
 					}
 				});
 			}
 		});

 		  		// Preload background images for instant switching
  		preloadBackgroundImages();
  		
  		// Load blog posts from XML
  		loadBlogPosts();
  		
  		// Highlight current page in navigation
  		const currentPage = 'essays-articles';
  		const currentNavLinks = document.querySelectorAll('.homepage-nav-link');
  		currentNavLinks.forEach(link => {
  			if (link.getAttribute('href') === currentPage) {
  				link.classList.add('current-page');
  			}
  		});
  		
  		// Initialize lazy loading for blog post images
  		initLazyLoading();
  		
  		// Initialize back to top button
  		initBackToTop();
  		
		// Smooth resize handling - only at 640px breakpoint, only featured cards
		let currentViewport = window.innerWidth <= 640 ? 'mobile' : 'desktop';
		
		window.addEventListener('resize', function() {
			// Only regenerate if we have posts loaded
			if (allPosts.length > 0) {
				const newViewport = window.innerWidth <= 640 ? 'mobile' : 'desktop';
				
				// Only regenerate if we've crossed the 640px threshold
				if (newViewport !== currentViewport) {
					currentViewport = newViewport;
					
					// Get current filtered posts
					const filteredPosts = allPosts.filter(post => currentFilter === 'all' ? true : post.type === currentFilter);
					const featuredPosts = filteredPosts.filter(post => post.featured);
					
					// Only regenerate featured cards
					const featuredCards = document.querySelectorAll('.featured-card');
					featuredPosts.forEach(post => {
						const newHTML = generateFeaturedPostHTML(post);
						// Find the matching featured card by title and replace it
						const existingCard = Array.from(featuredCards).find(card => {
							const titleElement = card.querySelector('.featured-card-title');
							return titleElement && titleElement.textContent.trim() === post.title;
						});
						if (existingCard) {
							existingCard.outerHTML = newHTML;
						}
					});
					
					// Reinitialize lazy loading for the new featured cards
					initLazyLoading();
				}
			}
		});
  	});
  	
  	// Lazy loading for blog post images only
  	function initLazyLoading() {
  		// Only initialize if not already initialized
  		if (window.imageObserver) {
  			window.imageObserver.disconnect();
  		}
  		
  		window.imageObserver = new IntersectionObserver((entries, observer) => {
  			entries.forEach(entry => {
  				if (entry.isIntersecting) {
  					const photo = entry.target;
  					const src = photo.getAttribute('data-src');
  					if (src) {
  						photo.style.backgroundImage = `url('${src}')`;
  						photo.removeAttribute('data-src');
  						observer.unobserve(photo);
  					}
  				}
  			});
  		}, {
  			rootMargin: '50px 0px',
  			threshold: 0.1
  		});
  		
  		// Only observe card images with data-src - explicitly exclude filter buttons
  		document.querySelectorAll('.card-image[data-src], .featured-card-image[data-src]').forEach(photo => {
  			// Double-check it's not a filter button
  			if (!photo.closest('.blog-filter-bar') && !photo.classList.contains('filter-btn')) {
  				window.imageObserver.observe(photo);
  			}
  		});
  	}

  	// Function to convert date string to Date object
  	function parseDate(dateStr) {
  		const months = {
  			'January': 0, 'February': 1, 'March': 2, 'April': 3, 'May': 4, 'June': 5,
  			'July': 6, 'August': 7, 'September': 8, 'October': 9, 'November': 10, 'December': 11
  		};
  		
  		const parts = dateStr.split(' ');
  		if (parts.length === 2) {
  			const month = months[parts[0]];
  			const year = parseInt(parts[1]);
  			return new Date(year, month, 1); // Use first day of month for sorting
  		}
  		return new Date(0); // Fallback for invalid dates
  	}

  	// Global variables for filtering and pagination
  	let allPosts = [];
  	let currentFilter = 'all';
  	let postsPerPage = 20;
  	let currentlyDisplayed = 0;
  	let filteredPostsList = [];
  	let loadMoreObserver = null;
  	let isLoadingMore = false; // Flag to prevent multiple simultaneous loads
  	
  	// Function to load and display blog posts
  	async function loadBlogPosts() {
  		try {
  			const response = await fetch('blog-posts.xml');
  			const xmlText = await response.text();
  			const parser = new DOMParser();
  			const xmlDoc = parser.parseFromString(xmlText, 'text/xml');
  			
  			const posts = xmlDoc.querySelectorAll('post');
  			const featuredPosts = [];
  			const regularPosts = [];
  			
			// Parse all posts
			posts.forEach(post => {
				const postData = {
					featured: post.getAttribute('featured') === 'true',
					type: post.getAttribute('type'),
					title: post.querySelector('title')?.textContent || '',
					subtitle: post.querySelector('subtitle')?.textContent || '',
					description: post.querySelector('description')?.textContent || '',
					author: post.querySelector('author')?.textContent || '',
					date: post.querySelector('date')?.textContent || '',
					publication: post.querySelector('publication')?.textContent || '',
					image: post.querySelector('image')?.textContent || '',
					link: post.querySelector('link')?.textContent || '',
					linkText: post.querySelector('link-text')?.textContent || 'View Article'
				};
				
				if (postData.featured) {
					featuredPosts.push(postData);
				} else {
					regularPosts.push(postData);
				}
			});
  			
  			// Sort regular posts by date (newest first)
  			regularPosts.sort((a, b) => {
  				const dateA = parseDate(a.date);
  				const dateB = parseDate(b.date);
  				return dateB - dateA;
  			});
  			
			// Store all posts globally for filtering
			allPosts = [...featuredPosts, ...regularPosts];
			
			// Generate filter buttons dynamically
			generateFilterButtons(allPosts);
			
			// Initialize filter buttons FIRST to ensure they work properly
			initFilterButtons();
			
			// Display all posts initially (excluding podcasts)
			filterPosts('all');
			
		} catch (error) {
			console.error('Error loading blog posts:', error);
			document.getElementById('blog-container').innerHTML = '<p>Error loading blog posts. Please try again later.</p>';
		}
	}
	
	// Function to generate filter buttons dynamically
	function generateFilterButtons(posts) {
		// Get unique post types from all posts
		let postTypes = [...new Set(posts.map(post => post.type))].sort();
		
		// Check if Podcasts category exists and move it to the end
		if (postTypes.includes('Podcasts')) {
			postTypes = postTypes.filter(type => type !== 'Podcasts');
			postTypes.push('Podcasts');
		}
		
		// Create filter bar HTML with call-to-action text
		let filterHTML = '<p class="filter-text"><a href="https://adamlehodey.substack.com/" target="_blank" class="subscribe-link">Subscribe</a> for deeper insights on New York City, urbanism, philosophy, literature and more.</p><div class="filter-buttons-container">';
		filterHTML += '<button class="filter-btn active" data-filter="all">All</button>';
		
		// Add buttons for each post type
		postTypes.forEach(type => {
			// Create display name for the filter button
			let displayName = type;
			switch(type) {
				case 'Analysis':
					displayName = 'Analysis / Opinion';
					break;
				case 'Prose/Verse':
					displayName = 'Verse / Prose';
					break;
				case 'Essays':
					displayName = 'Essays';
					break;
				case 'Podcasts':
					displayName = 'Podcasts';
					break;
				default:
					// For any new post types, use the type name as-is
					displayName = type;
			}
			
			filterHTML += `<button class="filter-btn" data-filter="${type}">${displayName}</button>`;
		});
		
		filterHTML += '</div>'; // Close the buttons container
		
		// Update the filter bar
		const filterBar = document.getElementById('blog-filter-bar');
		if (!filterBar) {
			console.error('Filter bar element not found!');
			return;
		}
		
		filterBar.innerHTML = filterHTML;
	}
	
  	// Function to display posts with pagination
  	function displayPosts(postsToShow, append = false) {
  		const container = document.getElementById('blog-container');
  		
  		// Separate featured and regular posts, then combine in order (featured first)
  		const featuredPosts = postsToShow.filter(post => post.featured);
  		const regularPosts = postsToShow.filter(post => !post.featured);
  		const orderedPosts = [...featuredPosts, ...regularPosts];
  		
  		// Calculate how many posts to show
  		let postsToDisplay;
  		if (append) {
  			// When appending, show next batch from the ordered list
  			const startIndex = currentlyDisplayed;
  			const endIndex = Math.min(startIndex + postsPerPage, orderedPosts.length);
  			postsToDisplay = orderedPosts.slice(startIndex, endIndex);
  			currentlyDisplayed = endIndex;
  		} else {
  			// Initial load - show first batch (up to postsPerPage)
  			postsToDisplay = orderedPosts.slice(0, postsPerPage);
  			currentlyDisplayed = postsToDisplay.length;
  		}
  		
  		// Separate the posts to display into featured and regular
  		const featuredToShow = postsToDisplay.filter(post => post.featured);
  		const regularToShow = postsToDisplay.filter(post => !post.featured);
  		
  		let html = '';
  		
  		// Add featured posts first
  		featuredToShow.forEach(post => {
  			html += generateFeaturedPostHTML(post);
  		});
  		
  		// Add regular posts with alternating layout
  		// Calculate starting alt class based on current display count
  		const existingCards = container.querySelectorAll('.brutalist-minimal-card').length;
  		let altClass = (existingCards % 2 === 0);
  		regularToShow.forEach(post => {
  			html += generateRegularPostHTML(post, altClass);
  			altClass = !altClass; // Alternate layout
  		});
  		
  		if (append) {
  			// Append new posts to existing content
  			const temp = document.createElement('div');
  			temp.innerHTML = html;
  			while (temp.firstChild) {
  				container.appendChild(temp.firstChild);
  			}
  		} else {
  			// Replace all content
  			container.innerHTML = '';
  			const temp = document.createElement('div');
  			temp.innerHTML = html;
  			while (temp.firstChild) {
  				container.appendChild(temp.firstChild);
  			}
  		}
  		
  		// Reinitialize lazy loading for new content
  		setTimeout(() => {
  			initLazyLoading();
  			// Setup observer for loading more posts
  			setupLoadMoreObserver();
  		}, 100);
  	}
  	
  	// Function to load more posts when scrolling
  	function loadMorePosts() {
  		// Prevent multiple simultaneous loads (debouncing)
  		if (isLoadingMore) {
  			return;
  		}
  		
  		// Calculate total ordered posts (featured + regular)
  		const featuredPosts = filteredPostsList.filter(post => post.featured);
  		const regularPosts = filteredPostsList.filter(post => !post.featured);
  		const totalOrderedPosts = featuredPosts.length + regularPosts.length;
  		
  		if (currentlyDisplayed >= totalOrderedPosts) {
  			// All posts are already displayed
  			if (loadMoreObserver) {
  				loadMoreObserver.disconnect();
  			}
  			return;
  		}
  		
  		// Set loading flag to prevent duplicate loads
  		isLoadingMore = true;
  		
  		// Load next batch
  		displayPosts(filteredPostsList, true);
  		
  		// Reset loading flag after a short delay to allow DOM updates to complete
  		setTimeout(() => {
  			isLoadingMore = false;
  		}, 300);
  	}
  	
  	// Function to setup IntersectionObserver for auto-loading more posts
  	function setupLoadMoreObserver() {
  		// Disconnect previous observer if it exists
  		if (loadMoreObserver) {
  			loadMoreObserver.disconnect();
  		}
  		
  		// Check if there are more posts to load
  		const featuredPosts = filteredPostsList.filter(post => post.featured);
  		const regularPosts = filteredPostsList.filter(post => !post.featured);
  		const totalOrderedPosts = featuredPosts.length + regularPosts.length;
  		
  		if (currentlyDisplayed >= totalOrderedPosts) {
  			return;
  		}
  		
  		// Find all cards (both featured and regular)
  		const cards = document.querySelectorAll('.brutalist-minimal-card, .featured-card');
  		if (cards.length === 0) {
  			return;
  		}
  		
  		// Observe the last card in the current batch
  		// This will trigger loading more when user scrolls near the end of current content
  		const lastCardIndex = cards.length - 1;
  		const breakpointCard = cards[lastCardIndex];
  		
  		if (!breakpointCard) {
  			return;
  		}
  		
  		// Create observer to watch for when last card comes into view
  		loadMoreObserver = new IntersectionObserver((entries) => {
  			entries.forEach(entry => {
  				if (entry.isIntersecting) {
  					// Load more posts when last card is near viewport
  					loadMorePosts();
  				}
  			});
  		}, {
  			rootMargin: '300px 0px', // Start loading 300px before the last card for smoother experience
  			threshold: 0.1
  		});
  		
  		loadMoreObserver.observe(breakpointCard);
  	}
  	
  	// Function to initialize filter buttons
  	function initFilterButtons() {
  		const filterButtons = document.querySelectorAll('.filter-btn');
  		filterButtons.forEach(button => {
  			button.addEventListener('click', function() {
  				const filter = this.getAttribute('data-filter');
  				
  				// Update active button styling
  				filterButtons.forEach(btn => btn.classList.remove('active'));
  				this.classList.add('active');
  				
  				// Filter posts
  				filterPosts(filter);
  			});
  		});
  	}
  	
  	// Preload background image
  	function preloadBackgroundImages() {
  		const img = new Image();
  		img.src = 'site-resources/cover-photos/essays.jpg';
  	}
  	
	// Function to filter posts
	function filterPosts(filter) {
		currentFilter = filter;
		
		let filteredPosts;
		if (filter === 'all') {
			// Hide podcasts by default when "All" is selected
			if (allPosts.some(post => post.type === 'Podcasts')) {
				filteredPosts = allPosts.filter(post => post.type !== 'Podcasts');
			} else {
				filteredPosts = allPosts;
			}
		} else {
			filteredPosts = allPosts.filter(post => post.type === filter);
		}
		
		// Store filtered posts and reset pagination
		filteredPostsList = filteredPosts;
		currentlyDisplayed = 0;
		
		// Reset loading flag when filter changes
		isLoadingMore = false;
		
		// Disconnect previous observer if it exists
		if (loadMoreObserver) {
			loadMoreObserver.disconnect();
			loadMoreObserver = null;
		}
		
		displayPosts(filteredPosts);
	}

  	// Function to generate featured post HTML
  	function generateFeaturedPostHTML(post) {
  		// Check if mobile view (screen width <= 640px)
  		const isMobile = window.innerWidth <= 640;
  		
  		if (isMobile) {
  			// Mobile HTML structure - stacked layout
  			return `
  				<div class="featured-card">
  					<div class="featured-card-content">
  						<div class="featured-card-image" data-src="${post.image}" style="background-image: url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMSIgaGVpZ2h0PSIxIiB2aWV3Qm94PSIwIDAgMSAxIiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxyZWN0IHdpZHRoPSIxIiBoZWlnaHQ9IjEiIGZpbGw9IiNmMGYwZjAiLz48L3N2Zz4=');"></div>
  						<div class="featured-card-text">
  							<h3 class="featured-card-title" onclick="window.open('${post.link}', '_blank')">${post.title}</h3>
  							<p class="featured-card-subtitle">${post.subtitle}</p>
  							<p class="featured-card-excerpt">${post.description}</p>
  							<button class="card-button" onclick="window.open('${post.link}', '_blank')">${post.linkText}</button>
  						</div>
  					</div>
  				</div>
  			`;
  		} else {
  			// Desktop HTML structure - overlay text on image
  			return `
  				<div class="featured-card">
  					<div class="featured-card-content">
  						<div class="featured-card-image" data-src="${post.image}" style="background-image: url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMSIgaGVpZ2h0PSIxIiB2aWV3Qm94PSIwIDAgMSAxIiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxyZWN0IHdpZHRoPSIxIiBoZWlnaHQ9IjEiIGZpbGw9IiNmMGYwZjAiLz48L3N2Zz4=');">
  							<div class="featured-card-text">
  								<h3 class="featured-card-title" onclick="window.open('${post.link}', '_blank')">${post.title}</h3>
  								<p class="featured-card-subtitle">${post.subtitle}</p>
  								<p class="featured-card-excerpt">${post.description}</p>
  								<button class="card-button" onclick="window.open('${post.link}', '_blank')">${post.linkText}</button>
  							</div>
  						</div>
  					</div>
  				</div>
  			`;
  		}
  	}

	// Function to generate regular post HTML
	function generateRegularPostHTML(post, altClass) {
		const altClassStr = altClass ? ' alt' : '';
		return `
			<div class="brutalist-minimal-card${altClassStr}">
				<div class="card-content">
					<div class="card-image" data-src="${post.image}" style="background-image: url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMSIgaGVpZ2h0PSIxIiB2aWV3Qm94PSIwIDAgMSAxIiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxyZWN0IHdpZHRoPSIxIiBoZWlnaHQ9IjEiIGZpbGw9IiNmMGYwZjAiLz48L3N2Zz4=');"></div>
					<div class="card-text">
						<div class="card-meta-header">
							<span class="post-type">${post.type}</span>
							<span class="read-time">${post.date} | ${post.publication}</span>
						</div>
						<h3 class="card-title" onclick="window.open('${post.link}', '_blank')">${post.title}</h3>
						<p class="card-subtitle">${post.subtitle}</p>
						<p class="card-excerpt">${post.description}</p>
						<button class="card-button" onclick="window.open('${post.link}', '_blank')">${post.linkText}</button>
					</div>
				</div>
			</div>
		`;
	}
	
	// Function to initialize back to top button
	function initBackToTop() {
		const backToTopBtn = document.getElementById('back-to-top');
		
		// Show/hide button based on scroll position
		function toggleBackToTop() {
			if (window.pageYOffset > 300) {
				backToTopBtn.classList.add('visible');
			} else {
				backToTopBtn.classList.remove('visible');
			}
		}
		
		// Smooth scroll to top
		backToTopBtn.addEventListener('click', function(e) {
			e.preventDefault();
			window.scrollTo({
				top: 0,
				behavior: 'smooth'
			});
		});
		
		// Listen for scroll events
		window.addEventListener('scroll', toggleBackToTop);
		
		// Initial check
		toggleBackToTop();
	}
  </script>
</body>
</html>
